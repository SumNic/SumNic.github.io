<!DOCTYPE html>
<html>
 <head>
    <meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Равноденствие</title>
  <link rel="shortcut icon" href="img/Earth.png" type="image/png">
  <link rel="stylesheet" href="css/style.css">
 </head>
 <body>
    <div class="wrapper" id="wrap">
		
		<div class="date__input">
			Укажите дату:  <input type="date" id="data">
			<button type="button" onclick="FunctionEnter()">Выбрать</button>
		</div>

        
        <div class="sol" id="sole">
            <img src="img/Sol.png" alt="Солнце">
        </div>
        <div id="result" class="result">
			<canvas id="graph"></canvas>
			<p id="demo"></p>
			

		</div>
		<div class="said">
			<h1></h1>
		</div>
        

    </div>
	

    

<script>
	var style, wP, wW, angle;
	var d = new Date();

		
	myFunction ();

	function myFunction() {
		wW = document.documentElement.clientWidth;
		wP = document.getElementById('wrap').clientWidth;
		console.log(wW, wP);
		document.getElementById('sole').style = "top:" + (wP/2+33) + "px";
		document.getElementById('result').style = "height:" + wP + "px";
		
		// document.getElementById('graph').clientHeight = "height:" + wP + "px;width:" + wP + "px";
		
		var today = Date.parse(d);
		var todayDay = today/1000/60/60/24;
		var yearDay = Math.floor(todayDay/365.24236-30)+2000;
		var year2000 = Date.parse(new Date(2000, 0, 01, 12, 0, 0, 0))/1000/60/60/24;
		var autumnEquinox = year2000 + 78.814 + 92.7388133 + 93.65911892 + 365.24236 * (yearDay - 2000);
		var corDay = (todayDay - autumnEquinox)*360/365.24236;
		w = wW/2 + (wP/3.3) * Math.cos(corDay * Math.PI / 180);
		h = wP/2 +40 - wP/3.3 * Math.sin(corDay * Math.PI / 180);
		style = "left:" + w + "px;top:" + h + "px ";
		var Earth = "<img id=\'earth\' src=\'img/Earth.png\' style=" + style + " >";
		document.getElementById('demo').innerHTML = Earth;

		// разметка месяцев 

			document.getElementById('graph').height = wP;
			document.getElementById('graph').width = wP;
			var canvas = document.getElementById('graph');
   			var ctx = canvas.getContext('2d');

		   	ctx.beginPath();

		for (i=0; i<12; i++) {
			var year01 = Date.parse(new Date(yearDay, i, 1, 0, 0, 0, 0))/1000/60/60/24;
			
			var cor01 = (year01 - autumnEquinox)*360/365.24236;
			w01 = wP/2 + wP/3 * Math.cos(cor01 * Math.PI / 180);
			h01 = wP/2 - wP/3 * Math.sin(cor01 * Math.PI / 180);

			w02 = wP/2 + wP/2.6 * Math.cos(cor01 * Math.PI / 180);
			h02 = wP/2 - wP/2.6 * Math.sin(cor01 * Math.PI / 180);
		


			
			ctx.moveTo(w01, h01);
			ctx.lineTo(w02, h02);
			ctx.strokeStyle = '#ccc'; 
			ctx.lineWidth = 1; 
		}	
		ctx.stroke();

		ctx.beginPath();
		var x = 0;
		for (g=0; g < 4; g++) {
			if (g==0) {
				x = 0;
			} else if (g==1){ 
				x -= 92.7388133;
			} else if (g==2){ 
				x -= 93.65911892;
			} else if (g==3){ 
				x -= 89.86079102;
			}
			var corEq = (0 + x)*360/365.24236;
			wEq1 = wP/2 + wP/3.8 * Math.cos(corEq * Math.PI / 180);
			hEq1 = wP/2 - wP/3.8 * Math.sin(corEq * Math.PI / 180);

			wEq2 = wP/2 + wP/3 * Math.cos(corEq * Math.PI / 180);
			hEq2 = wP/2 - wP/3 * Math.sin(corEq * Math.PI / 180);
		


			
			ctx.moveTo(wEq1, hEq1);
			ctx.lineTo(wEq2, hEq2);
			ctx.strokeStyle = 'red'; // тёмно-синий цвет
			ctx.lineWidth = 1; // толщина линии в 5px

		}
		ctx.stroke();
	}
	function FunctionEnter() {
		d = document.getElementById('data').value
		myFunction();
	}


	window.addEventListener('resize', function (event) {
		console.log('resize');
		myFunction ();
	}, true);

</script>


 </body>
</html>